% # context : data, utils, sem, parcours
%% set year=utils.semestre2year(sem)
\newpage
\fancyfoot[R]{2021\\\VAR{data.getId()|le} (parcours \VAR{parcours.getLettreList()|elegantjoin|le})}
\begin{center}
  {
    \fontsize{24}{36}\fontspec{Arial}\bfseries
    Coefficients S\VAR{sem|le} — Parcours \VAR{parcours.getLettreList()|elegantjoin|le}
  }\\
  \large
  \VAR{parcours.getNameList()|elegantjoin|le}
\end{center}
%% for subparc in data.getParcoursObjects(semestre=sem,interparcours=parcours)
\begin{center}
  %% set comps=data.getPossibleCompObjects([subparc],year)
  %% set comptabform='c|'*comps.__len__()
  %% set allcolumns=comps.__len__()+1
  \begin{tabular}{|l|\VAR{comptabform}}\hline
    Ressource/SAÉ
    & 
    %% for c in comps:
      \rotatebox{90}{C\VAR{c.getNum()|le}~\VAR{c.getShorttxt()|le}}
      %% if not loop.last
    &
    %% endif
    %% endfor
    \\\hline
    %% set lr=data.getRessourceObjects(semestre=sem,parcours=subparc)
    %% set ls=data.getSAEObjects(semestre=sem,parcours=subparc)
    %% for ll,lcode,Lname in [(ls,'SAE','SAÉ'),(lr,'RESS','Ressources')]
    \textbf{\VAR{Lname}}
    &
    %% for c in comps:
    %% set co=c.getCoeffs(onlyType=[lcode],semestre=sem)
    %% if co
      \textbf{\VAR{co[1]|le}}
      %% endif
      %% if not loop.last:
    &
    %% endif
    %% endfor
    \\\hline
    %% for m in ll
    \VAR{m.getId()|le}~\VAR{m.getLongtxt()|le}
    &
    %% for c in comps:
    %% set co=c.getCoeff(m)
    %% if co
      \VAR{co[1]|le}
      %% endif
      %% if not loop.last:
    &
    %% endif
    %% endfor
    \\\hline
    %% endfor
    %% endfor
    \textbf{Total}
    &
    %% for c in comps:
    %% set co=c.getCoeffs(onlyType=['RESS','SAE'],semestre=sem)
    %% if co
      \textbf{\VAR{co[1]|le}}
      %% endif
      %% if not loop.last:
    &
    %% endif
    %% endfor
    \\\hline
  \end{tabular}
\end{center}
%% endfor
