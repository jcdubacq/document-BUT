\documentclass[10pt,mathserif]{beamer}
\usepackage[LUC,T2A,T1]{fontenc}%
\usepackage[utf8x]{inputenc}%
\usepackage{arev}
\usepackage{tgtermes,tgadventor}
\usepackage[condensed]{tgheros}
\usepackage{bookmark}
\usepackage{textcomp}
\usepackage{colortbl}%
\usepackage{etoolbox}
\usepackage[french]{babel}
\geometry{landscape,a4paper,left=25mm,right=25mm,top=25 mm,bottom=25mm}
\usepackage{tikz}%
\usetikzlibrary{calc,fit,shapes,arrows,shadows.blur}%
\pgfdeclarelayer{background}%
\pgfdeclarelayer{foreground}%
\pgfsetlayers{background,main,foreground}%
% \usecolortheme{solarized}
\useoutertheme{infolines}
\useinnertheme{circles}
\setbeamertemplate{blocks}[rounded][shadow=false]
\setbeamercovered{transparent}
\setbeamertemplate{sections in toc}[default]
\setbeamertemplate{subsections in toc}[default]
\setbeamertemplate{enumerate items}[default]
% \setbeamertemplate{itemize items}[default]
% \setbeamertemplate{itemize items}[circle]
\setbeamertemplate{itemize items}{$\bullet$}



\title{Référentiel de compétences}
\subtitle{Spécialité : informatique}
\institute{ACD Informatique}
\date{\today}
\author{(many people)}%


\definecolor{titlebg}{HTML}{0d5769}
\definecolor{compA}{HTML}{C70000}
\definecolor{compB}{HTML}{FD904D}
\definecolor{compC}{HTML}{FFC000}
\definecolor{compD}{HTML}{90D146}
\definecolor{compE}{HTML}{031F3C}
\definecolor{compF}{HTML}{6612D0}
\definecolor{compAp}{HTML}{000000}
\definecolor{compBp}{HTML}{000000}
\definecolor{compCp}{HTML}{000000}
\definecolor{compDp}{HTML}{000000}
\definecolor{compEp}{HTML}{FFFFFF}
\definecolor{compFp}{HTML}{FFFFFF}
\definecolor{titlebg}{HTML}{07355f}
\definecolor{titlefg}{HTML}{b4dee9}
\newcounter{domains}
\newcounter{metier}
\newcounter{parcours}
\newcounter{attenduG}
\newcounter{attenduTS}
\newcounter{attenduH}
\newcounter{domainsl}
\newcounter{matrix}

\xdef\comploop{A,B,C,D,E,F}
\xdef\compoloop{A,B,C,D,E,F,G,H}
\xdef\situloop{A,B,C,D,E,F,G,H}
\xdef\defiloop{A,B,C,D,E,F,G,H}
\xdef\attenduloop{A,B,C,D,E,F,G,H}
\xdef\apploop{A,B,C,D,E,F,G,H,I,J}
\xdef\metierloop{A,B,C,D,E,F,G,H,I,J}
\xdef\nivloop{A,B,C}
\xdef\anneeloop{1,2,3}

\def\specialite#1{\def\specialitename{#1}}
\def\nouveaudomaine#1#2{\addtocounter{domains}{1}\expandafter\def\csname domaine\Alph{domains}\endcsname{#2}\ifnum\value{domains}=1\xdef\domainsloop{\Alph{domains}}\else\xdef\domainsloop{\domainsloop,\Alph{domains}}\fi}
\def\nouveauparcours#1{\setcounter{metier}{0}\addtocounter{parcours}{1}\expandafter\def\csname parcours\Alph{parcours}\endcsname{#1}\ifnum\value{parcours}=1\xdef\parcoursloop{\Alph{parcours}}\else\xdef\parcoursloop{\parcoursloop,\Alph{parcours}}\fi}
\def\nouvelattendugeneral#1{\addtocounter{attenduG}{1}\expandafter\def\csname attenduG\Alph{attenduG}\endcsname{#1}\ifnum\value{attenduG}=1\xdef\attenduGloop{\Alph{attenduG}}\else\xdef\attenduGloop{\attenduGloop,\Alph{attenduG}}\fi}
\def\nouvelattendutech#1{\addtocounter{attenduTS}{1}\expandafter\def\csname attenduTS\Alph{attenduTS}\endcsname{#1}\ifnum\value{attenduTS}=1\xdef\attenduTSloop{\Alph{attenduTS}}\else\xdef\attenduTSloop{\attenduTSloop,\Alph{attenduTS}}\fi}
\def\nouvelattenduhumain#1{\addtocounter{attenduH}{1}\expandafter\def\csname attenduH\Alph{attenduH}\endcsname{#1}\ifnum\value{attenduH}=1\xdef\attenduHloop{\Alph{attenduH}}\else\xdef\attenduHloop{\attenduHloop,\Alph{attenduH}}\fi}

\def\nouveaumetieraccessible#1{\addtocounter{metier}{1}\expandafter\def\csname parcours\Alph{parcours}metier\Alph{metier}\endcsname{#1}\expandafter\def\csname parcours\Alph{parcours}metier\Alph{metier}mark\endcsname{$\bullet$}%
\expandafter\def\csname parcours\Alph{parcours}metier\Alph{metier}font\endcsname{\bfseries\selectfont}%
}
\def\nouveaumetiersenior#1{\addtocounter{metier}{1}\expandafter\def\csname parcours\Alph{parcours}metier\Alph{metier}\endcsname{#1}\expandafter\def\csname parcours\Alph{parcours}metier\Alph{metier}mark\endcsname{$\Rightarrow$}%
\expandafter\def\csname parcours\Alph{parcours}metier\Alph{metier}font\endcsname{\mdseries\selectfont}%
}
\def\nouveaumetierpossible#1{\addtocounter{metier}{1}\expandafter\def\csname parcours\Alph{parcours}metier\Alph{metier}\endcsname{#1}\expandafter\def\csname parcours\Alph{parcours}metier\Alph{metier}mark\endcsname{$\bullet$}%
\expandafter\def\csname parcours\Alph{parcours}metier\Alph{metier}font\endcsname{\mdseries\selectfont}%
}

\def\competenceparcoursniveaux#1#2#3#4{%
  \expandafter\xdef\csname comp#3parcours#4annee#2\endcsname{#1}}

\def\competenceparcoursniveau#1#2#3{%
  \expandafter\def\csname comp#1parcours#2\endcsname{1}
  \foreach \niveau [count=\AN] in {#3} {
    \if\niveau\relax\relax\else
    \expandafter\competenceparcoursniveaux\niveau\AN#1#2
    \fi
  }
}

\def\nouvellecompetence#1#2#3{\expandafter\def\csname comp#1name\endcsname{#2}\expandafter\def\csname comp#1defA\endcsname{#3}\newcounter{compsitu#1}\newcounter{compniveau#1}\newcounter{compcompo#1}\newcounter{compdef#1}\addtocounter{compdef#1}{1}\newcounter{compapp#1A}\newcounter{compapp#1B}\newcounter{compapp#1C}}
\def\ajoutniveauvide#1{\addtocounter{compniveau#1}{1}}
\def\ajoutniveau#1#2#3{\addtocounter{compniveau#1}{1}%
  \expandafter\def\csname comp#1niv\Alph{compniveau#1}\endcsname{#3}%
  \ifx#2\relax\relax%
  \expandafter\xdef\csname comp#1niv\Alph{compniveau#1}name\endcsname{\csname niveau\Alph{compniveau#1}\endcsname}%
  \else%
  \expandafter\xdef\csname comp#1niv\Alph{compniveau#1}name\endcsname{#2}%
  \fi}

\def\ajoutdef#1#2{\addtocounter{compdef#1}{1}\expandafter\def\csname comp#1def\Alph{compdef#1}\endcsname{#2}}
\def\ajoutsituation#1#2{\addtocounter{compsitu#1}{1}\expandafter\def\csname comp#1situ\Alph{compsitu#1}\endcsname{#2}}
\def\ajoutcompo#1#2{\addtocounter{compcompo#1}{1}\expandafter\def\csname comp#1compo\Alph{compcompo#1}\endcsname{#2}}
\def\ajoutapprentissage#1#2#3#4{\addtocounter{compapp#1#2}{1}\expandafter\def\csname comp#1niv#2app\Alph{compapp#1#2}\endcsname{#3}%
  \setcounter{domainsl}{0}
  \xdef\varloop{#4}
  \ifx#4\relax\relax\xdef\varloop{0}\else\relax\fi
  \foreach \matrixpoint in \varloop {
    \addtocounter{domainsl}{1}
    \setcounter{matrix}{\matrixpoint}
    \ifnum\value{matrix}=1\relax
    \expandafter\xdef\csname comp#1niv#2app\Alph{compapp#1#2}dom\Alph{domainsl}\endcsname{\matrixpoint}%
    \else\relax\fi
    \ifnum\value{matrix}=2\relax
    \expandafter\xdef\csname comp#1niv#2app\Alph{compapp#1#2}domB\Alph{domainsl}\endcsname{\matrixpoint}%
    \else\relax\fi
  }
}


\def\niveauA{Niveau 1}
\def\niveauB{Niveau 2}
\def\niveauC{Niveau 3}

\def\niveauAfill{10}
\def\niveauBfill{45}
\def\niveauCfill{80}
\def\niveauAink{0}
\def\niveauBink{0}
\def\niveauCink{100}
\def\niveauApath{50}
\def\niveauBpath{75}
\def\niveauCpath{100}
\input{compx}

\def\stdsetup{
  % \draw ($ (current page.north west) + (10mm,-10mm) $) rectangle ($ (current page.south east) + (-10mm,10mm) $);
  \coordinate(lastpoint) at ($ (current page.north west) + (10mm,-12mm) $);
  \coordinate(toprightcorner) at ($ (current page.north east) + (-12mm,-12mm) $);
  \coordinate(splitpoint) at ($ (lastpoint) + (12cm,-12mm) $);
  \coordinate(splitpointbis) at ($ (splitpoint) + (1cm,2mm) $);
  \coordinate(refpoint) at ($ (lastpoint)+(25mm,0mm) $);
}

\begin{document}




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% FRAME TITLE
\begin{frame}
  \begin{tikzpicture}[overlay, remember picture]
    \coordinate(topleftcorner) at ($ (current page.north west) + (10mm,-12mm) $);
    \coordinate(toprightcorner) at ($ (current page.north east) + (-10mm,-10mm) $);
    \coordinate(bottomleftcorner) at ($ (current page.south west) + (10mm,10mm) $);
    \coordinate(bottomrightcorner) at ($ (current page.south east) + (-10mm,10mm) $);
    \fill[fill=titlebg,blur shadow={shadow blur steps=5}]($ (topleftcorner)+(-100mm,100mm) $) rectangle ($ 5/6*(bottomrightcorner)+1/6*(toprightcorner)+(100mm,0mm) $);
    \node [
    align=flush left,
    text width=240mm,
    text=titlefg,
    anchor=center,
    ] (title) at ($ .5*(bottomleftcorner)+.5*(toprightcorner)  $) {\fontfamily{qag}\bfseries\fontsize{40}{60}\selectfont Description des parcours \&\\Référentiel de compétences du\\B.U.T \specialitename\\\hfill\emph{Document de travail}\\};
    \node (shadowsquare) at (50mm,-40mm) {\includegraphics[width=100mm]{blur.png}};

    % 
    

  \end{tikzpicture}
\end{frame}




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% FRAME Métiers-Parcours
\begin{frame}[plain]{}
  \begin{tikzpicture}[overlay, remember picture]
    \stdsetup
    \node[text=titlebg]  [%
    outer sep=0,inner sep=0mm,%
    fit=(lastpoint)(splitpoint),
    align=left%
    ] (xtitle) {\fontsize{20}{40}\scshape\bfseries\selectfont \specialitename\\Les métiers et les parcours du B.U.T.};
    \fill[shade,left color=titlebg,right color=white] (xtitle.south west) rectangle ($ (xtitle.south east) + (0,1mm) $);
    \node[%
    outer sep=0,inner sep=2mm,%
    fit=(toprightcorner)(splitpointbis),
    rounded corners=2mm,
    fill=red!10!white,
    align=left%
    ] (blob) {Les parcours ont été établis d’après les métiers qui sont accessibles à l’issue du diplôme.\par\hspace*{5mm}\llap{$\bullet$} Métier accessible à la sortie du diplôme\\\hspace*{5mm}\llap{$\Rightarrow$} Métier senior};
    \coordinate(lastpoint) at ($ (xtitle.south west) + (0,-4mm) $);
    \foreach \XX [count=\COUXX] in \parcoursloop {%
      \coordinate (bottompoint) at ($ (lastpoint)+(0,-20mm) $);
      \coordinate (subrefpoint) at ($ (refpoint)+(50mm,0mm) $);
      \begin{pgfonlayer}{main}
        % \draw[thick](lastpoint)--++(-1cm,0);
        \node[outer sep=0,inner sep=0mm,%
        minimum height=20mm,%
        text width=200mm,%
        align=left,%
        text=black,fill=titlebg!\COUXX 0!white,%
        ] (rightbox) at (lastpoint-|subrefpoint) [anchor=north west] {%
          \begin{list}{$\bullet$}{\topsep=0pt \partopsep=0pt \parsep=0pt \itemsep=0pt \leftmargin=1em \itemindent=0em}%
            \foreach \YY in \metierloop {%
              \ifcsdef{parcours\XX metier\YY}{%
              \item[\csname parcours\XX metier\YY mark\endcsname]
                \textcolor{black}{%
                  \csname parcours\XX metier\YY font\endcsname\csname parcours\XX metier\YY\endcsname%
                }}{}%
            }%
          \end{list}%
        };
        \coordinate(bottompoint) at ($ (rightbox.south west)+(-10mm,0) $);
        \coordinate(toppoint) at ($ (lastpoint)+(32mm,0mm) $);
        \node[outer sep=0,inner sep=0mm,%
        align=right,%
        ] at ($ (rightbox.west)+(-10mm,0) $) [anchor=east] (leftbox) {%
          \Large\bfseries Métiers \\\Large\bfseries associés%
        };
      \end{pgfonlayer}
      \begin{pgfonlayer}{background}
        \coordinate(toppoint) at ($ (rightbox.north west)+(-2mm,2mm) $);
        \coordinate(bottompoint) at ($ (rightbox.south east)+(2mm,-2mm) $);
        \node[outer sep=0,inner sep=0mm,
        fit=(toppoint)(bottompoint),
        % fill=comp\XX, 
        text=black,fill=titlebg!\COUXX 0!white,%
        blur shadow={shadow blur steps=5}
        ] (bodybox) {};
        \coordinate (tmpa) at ($ (lastpoint)+(80mm,0) $);
        \coordinate (tmpb) at (tmpa|-bodybox.south);
        \fill[fill=titlebg!\COUXX 0!white] ($ (rightbox.north west)+(-6mm,0mm) $) rectangle ($ (rightbox.south west)+(-5mm,0) $);
        \coordinate(toppoint) at ($ (lastpoint)+(25mm,2mm) $);
        \node[%
        outer sep=0,inner sep=0mm,%
        text width=25mm,%
        fit=(toppoint)(lastpoint|-bodybox.south),%
        align=center,%
        text=black,fill=titlebg!\COUXX 0!white,%
        blur shadow={shadow blur steps=5}%
        ] (headbox) {\csname parcours\XX\endcsname};
      \end{pgfonlayer}
      \coordinate(lastpoint) at ($ (lastpoint|-bodybox.south) + (0,-4mm) $);
    }
    \coordinate(midpointA) at ($ 2/3*(topleftcorner)+1/3*(toprightcorner)+(-3mm,0) $);
    \coordinate(midpointB) at ($ 2/3*(topleftcorner)+1/3*(toprightcorner)+(3mm,0) $);
    \coordinate(midpointC) at ($ 1/3*(topleftcorner)+2/3*(toprightcorner)+(-3mm,0) $);
    \coordinate(midpointD) at ($ 1/3*(topleftcorner)+2/3*(toprightcorner)+(3mm,0) $);
    \ifcsdef{attenduGA}{
      \node[draw=black,inner sep=2mm,outer sep=2mm,anchor=north west,fit=(lastpoint|-bottomleftcorner)(lastpoint-|midpointA),align=flush left] (blockG) {
        {\large\bfseries Attendus généraux :}\\
        \begin{list}{$\bullet$}{\topsep=2mm \partopsep=0pt \parsep=0pt \itemsep=0pt \leftmargin=1em \itemindent=0em}%
          \foreach \YY in \attenduloop {%
            \ifcsdef{attenduG\YY}{\item \csname attenduG\YY\endcsname}{}%
          }%
        \end{list}
      };
    }{}%
    \ifcsdef{attenduTSA}{
      \node[draw=black,inner sep=2mm,outer sep=2mm,anchor=north west,fit=(bottomrightcorner-|midpointC)(lastpoint-|midpointB),align=flush left] (blockTS) {
        {\large\bfseries Attendus techniques et scientifiques :}\\
        \begin{list}{$\bullet$}{\topsep=2mm \partopsep=0pt \parsep=0pt \itemsep=0pt \leftmargin=1em \itemindent=0em}%
          \foreach \YY in \attenduloop {%
            \ifcsdef{attenduTS\YY}{\item \csname attenduTS\YY\endcsname}{}%
          }%
        \end{list}
      };
    }{}%
    \ifcsdef{attenduHA}{
      \node[draw=black,inner sep=2mm,outer sep=2mm,anchor=north west,fit=(bottomrightcorner)(lastpoint-|midpointD),align=flush left] (blockTS) {
        {\large\bfseries Qualités humaines :}\\
        \begin{list}{$\bullet$}{\topsep=2mm \partopsep=0pt \parsep=0pt \itemsep=0pt \leftmargin=1em \itemindent=0em}%
          \foreach \YY in \attenduloop {%
            \ifcsdef{attenduH\YY}{\item \csname attenduH\YY\endcsname}{}%
          }%
        \end{list}
      };
    }{}%
  \end{tikzpicture}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% FRAME PARCOURS / COMPETENCES (1/parcours)

\foreach \PAR [count=\COUPAR] in \parcoursloop {
  \begin{frame}[plain]{}
    \begin{tikzpicture}[overlay, remember picture]
      \stdsetup
      \coordinate (bottompoint) at  ($ (lastpoint)+(0,-30mm) $);
      \node[outer sep=0,inner sep=0mm,
      fit=(bottompoint)(toprightcorner),
      align=flush center,
      text=black,fill=titlebg!\COUPAR 0!white,%
      blur shadow={shadow blur steps=5}
      ] (xtitle) {
        \begin{hyphenrules}{nohyphenation}\Large\bfseries Parcours \PAR\\[3mm]%
          \csname parcours\PAR\endcsname%
        \end{hyphenrules}%
      };
      \coordinate (lastpoint) at ($ (lastpoint|-bottompoint)+(0,-4mm) $);
      \coordinate (topleft) at ($ (lastpoint)+(2mm,-2mm) $);
      \coordinate (offset) at (45mm,0);
      \coordinate (bottomright) at ($ (lastpoint)+(41mm,-32mm) $);
      \foreach \XX [count=\COUXX] in \comploop {
        \ifcsdef{comp\XX parcours\PAR}{
          \node[%
          outer sep=0,inner sep=2mm,%
          text width=25mm,%
          fit=(topleft)(bottomright),%
          align=flush center,%
          fill=comp\XX,text=comp\XX p,%
          blur shadow={shadow blur steps=5}%
          ] (headbox\XX) {\csname comp\XX name\endcsname};
          \coordinate(highright) at ($ (bottomright)+(2mm,-5mm) $);
          \coordinate(highleft) at ($ (highright-|topleft)+(-2mm,0) $);
          \coordinate(highmid) at ($ .5*(highright)+.5*(highleft) $);
          \coordinate(sep0) at ($ (highright)+(0,1mm) $);
          \foreach \AN [count=\COUAN] in \anneeloop {%
            % If compXXparcoursPARanneeAN exists:
            \ifcsdef{comp\XX parcours\PAR annee\AN}{
              \xdef\NIV{\csname comp\XX parcours\PAR annee\AN\endcsname}
              \coordinate(lowright) at ($ (highright)+(0mm,-30mm) $);
              \coordinate(lowleft) at ($ (highleft)+(0mm,-30mm) $);
              \coordinate(lowmid) at ($ .5*(lowright)+.5*(lowleft)+(0,-5mm) $);
              \draw[%
              thick,%
              fill=comp\XX!\csname niveau\NIV fill\endcsname!white,
              draw=comp\XX!\csname niveau\NIV path\endcsname!white,
              blur shadow={shadow blur steps=5}
              ](highright)--(highmid)--(highleft)--(lowleft)--(lowmid)--(lowright)--cycle;
              \node[%
              outer sep=0,inner sep=0mm,%
              text width=33mm,%
              fit=(highmid)(lowleft)(lowright),%
              align=flush center,%
              fill=comp\XX!\csname niveau\NIV fill\endcsname!white,
              text=comp\XX p!\csname niveau\NIV ink\endcsname!black,
              ] (headbox\XX\AN) {
                \textbf{\csname comp\XX niv\NIV name\endcsname}\\
                \begin{hyphenrules}{nohyphenation}\csname comp\XX niv\NIV\endcsname\end{hyphenrules}
              };
              \coordinate(highright) at ($ (lowright)+(0,-2mm) $);
              \coordinate(highleft) at ($ (lowleft)+(0,-2mm) $);
              \coordinate(highmid) at ($ (lowmid)+(0,-2mm) $);
            }{
              \coordinate(lowright) at ($ (highright)+(0mm,-30mm) $);
              \coordinate(lowleft) at ($ (highleft)+(0mm,-30mm) $);
              \coordinate(lowmid) at ($ .5*(lowright)+.5*(lowleft)+(0,-5mm) $);
              \coordinate(highright) at ($ (lowright)+(0,-2mm) $);
              \coordinate(highleft) at ($ (lowleft)+(0,-2mm) $);
              \coordinate(highmid) at ($ (lowmid)+(0,-2mm) $);
            }%
            \coordinate (sep\COUAN) at ($ (lowright)+(0,-1mm) $);
          }
          \coordinate (topleft) at ($ (topleft)+(offset) $);
          \coordinate (bottomright) at ($ (bottomright)+(offset) $);
        }{}%
      }
      \begin{pgfonlayer}{background}
        \foreach \AN [count=\COUAN] in \anneeloop {%
          \draw[draw=black,dashed,thin] (sep\COUAN-|topleftcorner)--(sep\COUAN-|toprightcorner);
          \pgfmathparse{int(\COUAN*2)};
          \edef\mylabel{\pgfmathresult}
          \node[anchor=north east,rotate=-90,xshift=-5mm] at (sep\COUAN-|toprightcorner) {
            S\mylabel
          };
          \pgfmathparse{int(\COUAN*2-1)};
          \edef\mylabel{\pgfmathresult}
          \pgfmathparse{int(\COUAN-1)};
          \edef\mylabelb{\pgfmathresult}
          \node[anchor=north west,rotate=-90,xshift=5mm] at (sep\mylabelb-|toprightcorner) {
            S\mylabel
          };
        }
      \end{pgfonlayer}
    \end{tikzpicture}
  \end{frame}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% FRAME 1

\begin{frame}[plain]{}
  \begin{tikzpicture}[overlay, remember picture]
    \stdsetup
    \node[text=titlebg]  [%
    outer sep=0,inner sep=0mm,%
    fit=(lastpoint)(splitpoint),
    align=left%
    ] (xtitle) {\fontsize{20}{40}\scshape\bfseries\selectfont Les grandes compétences et\\les composantes essentielles du B.U.T.};
    \fill[shade,left color=titlebg,right color=white] (xtitle.south west) rectangle ($ (xtitle.south east) + (0,1mm) $);
    \node[%
    outer sep=0,inner sep=2mm,%
    fit=(toprightcorner)(splitpointbis),
    rounded corners=2mm,
    fill=red!10!white,
    align=left%
    ] (blob) {Une \textbf{compétence} est un « \textbf{savoir-agir complexe}, prenant appui sur la mobilisation et la combinaison efficaces d’une variété de ressources à l’intérieur d’une famille de situations » (Tardif, 2006). Les ressources désignent ici les savoirs, savoir-faire et savoir-être dont dispose un individu, et qui lui permettent de mettre en œuvre la compétence.};
    \coordinate(lastpoint) at ($ (xtitle.south west) + (0,-4mm) $);
    
    \foreach \XX in \comploop {%
      \coordinate (bottompoint) at ($ (lastpoint)+(0,-20mm) $);
      \coordinate (subrefpoint) at ($ (refpoint)+(60mm,0mm) $);
      \ifcsdef{comp\XX defA}{
        \begin{pgfonlayer}{main}
          % \draw[thick](lastpoint)--++(-1cm,0);
          \node[outer sep=0,inner sep=0mm,%
          minimum height=20mm,%
          text width=190mm,%
          align=left,%
          text=comp\XX p,fill=comp\XX!70!white%
          ] (rightbox) at (lastpoint-|subrefpoint) [anchor=north west] {%
            \ifcsdef{comp\XX compoA}{
              \begin{list}{$\bullet$}{\topsep=0pt \partopsep=0pt \parsep=0pt \itemsep=0pt \leftmargin=1em \itemindent=0em}%
                \foreach \YY in \compoloop {%
                  \ifcsdef{comp\XX compo\YY}{\item \textcolor{comp\XX p}{en \csname comp\XX compo\YY\endcsname}}{}%
                }
              \end{list}%
            }{
              \textbf{Ici viennent les composantes essentielles}
            }%
          };
          \coordinate(bottompoint) at ($ (rightbox.south west)+(-5mm,0) $);
          \coordinate(toppoint) at ($ (lastpoint)+(32mm,0mm) $);
          \node[outer sep=0,inner sep=0mm,%
          % text width=45mm,%
          fit=(bottompoint)(toppoint),
          align=flush center,%
          fill=comp\XX,text=comp\XX p%
          ] (leftbox) {%
            \csname comp\XX defA\endcsname%
          };
        \end{pgfonlayer}
        \begin{pgfonlayer}{background}
          \coordinate(toppoint) at ($ (lastpoint)+(30mm,2mm) $);
          \coordinate(bottompoint) at ($ (rightbox.south east)+(2mm,-2mm) $);
          \coordinate(bottomwpoint) at ($ (leftbox.south east)+(2mm,-2mm) $);
          \node[outer sep=0,inner sep=0mm,
          fit=(leftbox)(rightbox)(toppoint)(bottompoint)(bottomwpoint),
          fill=comp\XX,
          blur shadow={shadow blur steps=5}
          ] (bodybox) {};
          \coordinate (tmpa) at ($ (lastpoint)+(80mm,0) $);
          \coordinate (tmpb) at (tmpa|-bodybox.south);
          \fill[fill=comp\XX!50!white] ($ (leftbox.north east)+(2mm,0mm) $) rectangle ($ (rightbox.south west)+(-2mm,0) $);
          \coordinate(toppoint) at ($ (lastpoint)+(25mm,2mm) $);
          \node[%
          outer sep=0,inner sep=0mm,%
          text width=25mm,%
          fit=(toppoint)(lastpoint|-bodybox.south),%
          align=center,%
          fill=comp\XX,text=comp\XX p,%
          blur shadow={shadow blur steps=5}%
          ] (headbox) {\csname comp\XX name\endcsname};
        \end{pgfonlayer}
        \coordinate(lastpoint) at ($ (lastpoint|-bodybox.south) + (0,-4mm) $);
      }{}%
    }
  \end{tikzpicture}
\end{frame}










%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% FRAME 2
\begin{frame}[plain]{}
  \begin{tikzpicture}[overlay, remember picture]
    \stdsetup
    \node[text=titlebg]  [%
    outer sep=0,inner sep=0mm,%
    fit=(lastpoint)(splitpoint),
    align=left%
    ] (xtitle) {\fontsize{20}{40}\scshape\bfseries\selectfont Les situations professionnelles};
    \fill[shade,left color=titlebg,right color=white] (xtitle.south west) rectangle ($ (xtitle.south east) + (0,1mm) $);
    \node[%
    outer sep=0,inner sep=2mm,%
    fit=(toprightcorner)(splitpointbis),
    rounded corners=2mm,
    fill=red!10!white,
    align=left%
    ] (blob) {Les situations professionnelles réfèrent aux \textbf{contextes} dans lesquels les compétences sont mises en jeu. Ses situations varient selon la compétence ciblée.};
    \coordinate(lastpoint) at ($ (xtitle.south west) + (0,-4mm) $);
    
    \foreach \XX in \comploop {%
      \ifcsdef{comp\XX defA}{      
        \coordinate (bottompoint) at ($ (lastpoint)+(0,-20mm) $);
        \coordinate (subrefpoint) at ($ (refpoint)+(50mm,0mm) $);
        \begin{pgfonlayer}{main}
          % \draw[thick](lastpoint)--++(-1cm,0);
          \node[outer sep=0,inner sep=0mm,%
          minimum height=20mm,%
          text width=200mm,%
          align=left,%
          % text=comp\XX p,fill=comp\XX%
          text=black,fill=comp\XX!20!white%
          ] (rightbox) at (lastpoint-|subrefpoint) [anchor=north west] {%
            \ifcsdef{comp\XX situA}{
              \begin{list}{\checkmark}{\topsep=0pt \partopsep=0pt \parsep=0pt \itemsep=0pt \leftmargin=1em \itemindent=0em}%
                \foreach \YY in \situloop {%
                  \ifcsdef{comp\XX situ\YY}{\item %
                    \textcolor{black}{%
                      \csname comp\XX situ\YY\endcsname%
                    }}{}%
                }
              \end{list}%
            }{\textbf{Les situations professionnelles n'ont pas encore été saisies.}}%
          };
          \coordinate(bottompoint) at ($ (rightbox.south west)+(-10mm,0) $);
          \coordinate(toppoint) at ($ (lastpoint)+(32mm,0mm) $);
          \node[outer sep=0,inner sep=0mm,%
          align=right,%
          ] at ($ (rightbox.west)+(-10mm,0) $) [anchor=east] (leftbox) {%
            \Large\bfseries Situations\\\Large\bfseries professionnelles%
          };
        \end{pgfonlayer}
        \begin{pgfonlayer}{background}
          \coordinate(toppoint) at ($ (rightbox.north west)+(-2mm,2mm) $);
          \coordinate(bottompoint) at ($ (rightbox.south east)+(2mm,-2mm) $);
          \node[outer sep=0,inner sep=0mm,
          fit=(toppoint)(bottompoint),
          % fill=comp\XX,
          text=black,fill=comp\XX!20!white,%
          blur shadow={shadow blur steps=5}
          ] (bodybox) {};
          \coordinate (tmpa) at ($ (lastpoint)+(80mm,0) $);
          \coordinate (tmpb) at (tmpa|-bodybox.south);
          \fill[fill=comp\XX] ($ (rightbox.north west)+(-6mm,0mm) $) rectangle ($ (rightbox.south west)+(-5mm,0) $);
          \coordinate(toppoint) at ($ (lastpoint)+(25mm,2mm) $);
          \node[%
          outer sep=0,inner sep=0mm,%
          text width=25mm,%
          fit=(toppoint)(lastpoint|-bodybox.south),%
          align=center,%
          fill=comp\XX,text=comp\XX p,%
          blur shadow={shadow blur steps=5}%
          ] (headbox) {\csname comp\XX name\endcsname};
        \end{pgfonlayer}
        \coordinate(lastpoint) at ($ (lastpoint|-bodybox.south) + (0,-4mm) $);
      }{}%
    }
  \end{tikzpicture}
\end{frame}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% FRAME 3
\begin{frame}[plain]{}
  \begin{tikzpicture}[overlay, remember picture]
    \stdsetup
    \node[text=titlebg]  [%
    outer sep=0,inner sep=0mm,%
    fit=(lastpoint)(splitpoint),
    align=left%
    ] (xtitle) {\fontsize{20}{40}\scshape\bfseries\selectfont Les définitions};
    \fill[shade,left color=titlebg,right color=white] (xtitle.south west) rectangle ($ (xtitle.south east) + (0,1mm) $);
    \node[%
    outer sep=0,inner sep=2mm,%
    fit=(toprightcorner)(splitpointbis),
    rounded corners=2mm,
    fill=red!10!white,
    align=left%
    ] (blob) {La définition met en phrase la compétence, ses composantes, ses niveaux et l’un ou l’autre des apprentissages critiques.};
    \coordinate(lastpoint) at ($ (xtitle.south west) + (0,-4mm) $);
    
    
    \foreach \XX in \comploop {%
      \ifcsdef{comp\XX defA}{
        \coordinate (bottompoint) at ($ (lastpoint)+(0,-20mm) $);
        \coordinate (subrefpoint) at ($ (refpoint)+(50mm,0mm) $);
        \begin{pgfonlayer}{main}
          % \draw[thick](lastpoint)--++(-1cm,0);
          \node[outer sep=0,inner sep=0mm,%
          minimum height=20mm,%
          text width=200mm,%
          align=left,%
          % text=comp\XX p,fill=comp\XX%
          text=black,fill=comp\XX!20!white,%
          ] (rightbox) at (lastpoint-|subrefpoint) [anchor=north west] {%
            \begin{list}{$\blacktriangleright$}{\topsep=0pt \partopsep=0pt \parsep=0pt \itemsep=0pt \leftmargin=1em \itemindent=0em}%
              \foreach \YY in \defiloop {%
                \ifcsdef{comp\XX def\YY}{%
                \item \textcolor{black}{%
                    \csname comp\XX def\YY\endcsname%
                  }}{}%
              }
            \end{list}%
          };
          \coordinate(bottompoint) at ($ (rightbox.south west)+(-10mm,0) $);
          \coordinate(toppoint) at ($ (lastpoint)+(32mm,0mm) $);
          \node[outer sep=0,inner sep=0mm,%
          % text width=45mm,%
          % fit=(bottompoint)(toppoint),
          align=right,%
          % fill=comp\XX,text=comp\XX p%
          ] at ($ (rightbox.west)+(-10mm,0) $) [anchor=east] (leftbox) {%
            \Large\bfseries Définition%
          };
        \end{pgfonlayer}
        \begin{pgfonlayer}{background}
          \coordinate(toppoint) at ($ (rightbox.north west)+(-2mm,2mm) $);
          \coordinate(bottompoint) at ($ (rightbox.south east)+(2mm,-2mm) $);
          \node[outer sep=0,inner sep=0mm,
          fit=(toppoint)(bottompoint),
          % fill=comp\XX,
          text=black,fill=comp\XX!20!white,%
          blur shadow={shadow blur steps=5}
          ] (bodybox) {};
          \coordinate (tmpa) at ($ (lastpoint)+(80mm,0) $);
          \coordinate (tmpb) at (tmpa|-bodybox.south);
          \fill[fill=comp\XX] ($ (rightbox.north west)+(-6mm,0mm) $) rectangle ($ (rightbox.south west)+(-5mm,0) $);
          \coordinate(toppoint) at ($ (lastpoint)+(25mm,2mm) $);
          \node[%
          outer sep=0,inner sep=0mm,%
          text width=25mm,%
          fit=(toppoint)(lastpoint|-bodybox.south),%
          align=center,%
          fill=comp\XX,text=comp\XX p,%
          blur shadow={shadow blur steps=5}%
          ] (headbox) {\csname comp\XX name\endcsname};
        \end{pgfonlayer}
        \coordinate(lastpoint) at ($ (lastpoint|-bodybox.south) + (0,-4mm) $);
      }{}%
    }
  \end{tikzpicture}
\end{frame}






%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% FRAME 4
% \def\XX{A}
\foreach \XX [count=\COUCOM] in \comploop {%
  \ifcsdef{comp\XX defA}{
    \begin{frame}[plain]{}
      \begin{tikzpicture}[overlay, remember picture]
        \stdsetup
        \coordinate(refpoint) at ($ (lastpoint)+(0mm,0mm) $);
        \coordinate (bottompoint) at ($ (lastpoint)+(0,-20mm) $);
        \coordinate (subrefpoint) at ($ (refpoint)+(70mm,0mm) $);
        \begin{pgfonlayer}{main}
          % \draw ($ (current page.north west) + (10mm,-10mm) $) rectangle ($ (current page.south east) + (-10mm,10mm) $);
          % \draw[thick](lastpoint)--++(-1cm,0);
          \node[outer sep=0,inner sep=0mm,%
          minimum height=20mm,%
          text width=130mm,%
          align=left,%
          text=comp\XX p,fill=comp\XX!70!white%
          ] (rightbox) at (lastpoint-|subrefpoint) [anchor=north west] {%
            \ifcsdef{comp\XX compoA}{
            \begin{list}{$\bullet$}{\topsep=0pt \partopsep=0pt \parsep=0pt \itemsep=0pt \leftmargin=1em \itemindent=0em}%
              \foreach \YY in \compoloop {%
                \ifcsdef{comp\XX compo\YY}{\item \textcolor{comp\XX p}{en \csname comp\XX compo\YY\endcsname}}{}%
              }
            \end{list}%
            }{\textbf{Les composantes essentielles n'ont pas été saisies}}
          };
          \node[outer sep=0,inner sep=0mm,%
          minimum height=20mm,%
          text width=73mm,%
          align=left,%
          text=comp\XX p,fill=comp\XX!90!white%
          ] (rightrightbox) at ($ (lastpoint-|rightbox.north east)+(2mm,0mm) $) [anchor=north west] {%
            \textbf{Définition}\begin{list}{}{\topsep=0pt \partopsep=0pt \parsep=0pt \itemsep=0pt \leftmargin=0em \itemindent=0em}%
              \foreach \YY in \defiloop {%
                \ifcsdef{comp\XX def\YY}{\item \small\textcolor{comp\XX p}{$\blacktriangleright$ \csname comp\XX def\YY\endcsname}}{}%
              }
            \end{list}%
          };
          \coordinate(bottompoint) at ($ (rightbox.south west)+(-5mm,0) $);
          \coordinate(toppoint) at ($ (refpoint) $);
          \node[outer sep=0,inner sep=0mm,%
          text width=63mm,%
          fit=(bottompoint)(toppoint),
          align=center,%
          fill=comp\XX,text=comp\XX p%
          ] (leftbox) {%
            \begin{hyphenrules}{nohyphenation}\Large\bfseries Compétence \COUCOM\\[3mm]\csname comp\XX name\endcsname\end{hyphenrules}%
          };
        \end{pgfonlayer}
        \begin{pgfonlayer}{background}
          \coordinate(toppoint) at ($ (lastpoint)+(30mm,2mm) $);
          \coordinate(bottompoint) at ($ (rightrightbox.south east)+(2mm,-2mm) $);
          \coordinate(bottomwpoint) at ($ (leftbox.south east)+(2mm,-2mm) $);
          \node[outer sep=0,inner sep=0mm,
          fit=(leftbox)(rightbox)(rightrightbox)(toppoint)(bottompoint)(bottomwpoint),
          fill=comp\XX,
          blur shadow={shadow blur steps=5}
          ] (bodybox) {};
          \coordinate (tmpa) at ($ (lastpoint)+(80mm,0) $);
          \coordinate (tmpb) at (tmpa|-bodybox.south);
          \fill[fill=comp\XX!50!white] ($ (leftbox.north east)+(2mm,0mm) $) rectangle ($ (bodybox.south west-|rightbox.south west)+(-2mm,2mm) $);
          \coordinate(toppoint) at ($ (lastpoint)+(25mm,2mm) $);
        \end{pgfonlayer}
        \coordinate(lastpoint) at ($ (lastpoint|-bodybox.south) + (0,-4mm) $);
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
        \coordinate (subrefpoint) at ($ (refpoint)+(45mm,0mm) $);
        \begin{pgfonlayer}{main}
          % \draw[thick](lastpoint)--++(-1cm,0);
          \node[outer sep=0,inner sep=0mm,%
          minimum height=20mm,%
          text width=225mm-(\value{domains}*5mm),%
          align=left,%
          text=black,fill=comp\XX!20!white%
          ] (rightbox) at (lastpoint-|subrefpoint) [anchor=north west] {%
            \ifcsdef{comp\XX situA}{%
            \begin{list}{\checkmark}{\topsep=0pt \partopsep=0pt \parsep=0pt \itemsep=0pt \leftmargin=1em \itemindent=0em}%
              \foreach \YY in \situloop {%
                \ifcsdef{comp\XX situ\YY}{\item \textcolor{black}{\csname comp\XX situ\YY\endcsname}}{}%
              }
            \end{list}%
            }{\textbf{Les situations professionnelles n'ont pas encore été saisies.}}%
          };
          \coordinate(bottompoint) at ($ (rightbox.south west)+(-10mm,0) $);
          \coordinate(toppoint) at ($ (lastpoint)+(32mm,0mm) $);
          \node[outer sep=0,inner sep=0mm,%
          % text width=45mm,%
          % fit=(bottompoint)(toppoint),
          align=right,%
          % fill=comp\XX,text=comp\XX p%
          ] at ($ (rightbox.west)+(-10mm,0) $) [anchor=east] (leftbox) {%
            \large\bfseries Situations\\\large\bfseries professionnelles%
          };
        \end{pgfonlayer}
        \ifcsdef{domaineA}{
          \coordinate (domaines) at ($ (lastpoint|-lastpoint)+(-400mm,0)+(0,2mm) $);
          \node[inner sep=0,outer sep=0,anchor=north west,text width=\value{domains}*5mm,align=center] (domtxt) at (domaines) {\textbf{Domaines de ressources}};
          \node[inner sep=0,outer sep=0,fit=(domaines)] (domcont) {};
          \foreach \DOM [count=\COU] in \domainsloop {%
            \coordinate (domanchor\DOM) at ($ (domtxt.south-|domaines)+(-5mm,-1mm)+5*(\COU mm,0) $);
            \node[inner sep=0,outer sep=0,rotate=90,anchor=north east] at (domanchor\DOM) (domtest\DOM) {\csname domaine\DOM\endcsname};
            \node[inner sep=0,outer sep=0,fit=(domcont)(domtest\DOM)] (domcont) {};
          }
          \node[inner sep=0,outer sep=0,anchor=west] (domtxt) at (domaines) {\textbf{Domaines de ressources}};
          \coordinate (domaines) at ($ (toprightcorner|-lastpoint)+\value{domains}*(-5mm,0mm)+(0,2mm) $); 
          \node[inner sep=0,outer sep=0,anchor=north west,text width=\value{domains}*5mm,align=center] (domtxt) at (domaines) {\textbf{Domaines de ressources}};
          \foreach \DOM [count=\COU] in \domainsloop {%
            \coordinate (domanchor\DOM) at ($ (domcont.south-|domaines)+(-5mm,-1mm)+5*(\COU mm,0) $);
            \node[inner sep=0,outer sep=0,rotate=90,anchor=north west] (domtxt\DOM) at (domanchor\DOM) {\csname domaine\DOM\endcsname};
          }
        }{
          \coordinate (domaines) at ($ (toprightcorner|-lastpoint) $);
          \coordinate (domtxtA) at ($ (domaines)+(0mm,-2mm) $);
        }
        \begin{pgfonlayer}{background}
          \coordinate(toppoint) at ($ (rightbox.north west)+(-2mm,2mm) $);
          \coordinate(bottompoint) at ($ (rightbox.south east)+(2mm,-2mm) $);
          \node[outer sep=0,inner sep=0mm,
          fit=(toppoint)(bottompoint),
          fill=comp\XX!20!white,
          blur shadow={shadow blur steps=5}
          ] (bodybox) {};
          \coordinate (tmpa) at ($ (lastpoint)+(80mm,0) $);
          \coordinate (tmpb) at (tmpa|-bodybox.south);
          \fill[fill=comp\XX] ($ (rightbox.north west)+(-6mm,0mm) $) rectangle ($ (rightbox.south west)+(-5mm,0) $);
        \end{pgfonlayer}
        \node[inner sep=2mm,outer sep=0,fit=(bodybox)(domtxtA.west)] (titlebox) {};
        \coordinate(lastpoint) at (lastpoint|-titlebox.south);
        \coordinate(highright) at ($ (rightbox.west|-lastpoint)+(-10mm,0) $);
        \coordinate(highleft) at (highright-|lastpoint);
        \coordinate(highmid) at ($ .5*(highright)+.5*(highleft) $);
        \foreach \NIV in \nivloop {%
          \ifcsdef{comp\XX niv\NIV name}{
            % \pause
            \begin{pgfonlayer}{main}
              % \draw[thick](lastpoint)--++(-1cm,0);
              \node[outer sep=0,inner sep=0mm,%
              minimum height=20mm,%
              text width=190mm,%
              align=left,%
              text=black,fill=white%
              ] (rightbox) at (lastpoint-|subrefpoint) [anchor=north west] {%
                \Large
                \ifcsdef{comp\XX niv\NIV appA}{
                  \begin{list}{$\bullet$}{\topsep=0pt \partopsep=0pt \parsep=0pt \itemsep=0pt \leftmargin=1em \itemindent=0em}%
                    \foreach \YY in \apploop {%
                      \ifcsdef{comp\XX niv\NIV app\YY}{\item %
                        \tikz[remember picture,overlay]{\coordinate(list\YY) at (0,0);%
                        }%
                        \textcolor{black}{\csname comp\XX niv\NIV app\YY\endcsname}}{}%
                    }
                  \end{list}%
                }{\textbf{Les apprentissages critiques n'ont pas encore été saisis}}%
              };
              \ifcsdef{domaineA}{
                \foreach \YY in \apploop {%
                  \ifcsdef{comp\XX niv\NIV app\YY}{
                    \foreach \DOM in \domainsloop {%
                      \ifcsdef{comp\XX niv\NIV app\YY dom\DOM}{%
                        \fill[fill=comp\XX] ($ (list\YY-|domtxt\DOM.north west)+(.5mm,0mm) $) rectangle ++(3mm,3mm);
                      }{
                        \ifcsdef{comp\XX niv\NIV app\YY domB\DOM}{%
                          \fill[fill=comp\XX] ($ (list\YY-|domtxt\DOM.north west)+(.5mm,0mm) $)--++(3mm,0)--++(-1.5mm,+3mm)--cycle;
                        }{
                          \fill[fill=black!20!white] ($ (list\YY-|domtxt\DOM.north west)+(.5mm,0mm) $) rectangle ++(3mm,3mm);
                        }
                      }
                    }
                  }
                }
              }{}
              \coordinate(lowright) at ($ (highright)+(0,-25mm) $);
              \coordinate(lowmid) at ($ (highmid)+(0,-25mm) $);
              \node[inner sep=0,outer sep=0,text width=33mm,anchor=north,align=center] (testarrow) at ($ (highmid)+(-200mm,-2mm) $) {
                \textbf{\csname comp\XX niv\NIV name\endcsname}\\
                \begin{hyphenrules}{nohyphenation}\csname comp\XX niv\NIV\endcsname\end{hyphenrules}
              };
              \node[inner sep=0,outer sep=0,fit=(rightbox)(lowright)(testarrow)] (thearrow) {};
              \coordinate(lowright) at (highright|-thearrow.south);
              \coordinate(lowleft) at (lowright-|lastpoint);
              \coordinate(lowmid) at ($ .5*(lowright)+.5*(lowleft)+(0,-5mm) $);
              \node[inner sep=0,outer sep=0,text width=33mm,anchor=north,%
              align=flush center,%
              text=comp\XX p!\csname niveau\NIV ink\endcsname!black] (arrow) at ($ (highmid)+(0mm,-2mm) $) {
                \textbf{\csname comp\XX niv\NIV name\endcsname}\\
                \csname comp\XX niv\NIV\endcsname
              };
            \end{pgfonlayer}
            \begin{pgfonlayer}{background}
              \draw[%
              thick,%
              fill=comp\XX!\csname niveau\NIV fill\endcsname!white,
              draw=comp\XX!\csname niveau\NIV path\endcsname!white,
              blur shadow={shadow blur steps=5}
              ](highright)--(highmid)--(highleft)--(lowleft)--(lowmid)--(lowright)--cycle;
            \end{pgfonlayer}

            \draw[thick,draw=comp\XX] ($ (highright)+(10mm,0) $)--(highright-|toprightcorner);
            \coordinate (lastpoint) at ($ (lastpoint|-lowleft)+(0,-2mm) $);
            \coordinate (highmid) at ($ (lowmid)+(0,-2mm) $);
            \coordinate (highleft) at ($ (lowleft)+(0,-2mm) $);
            \coordinate (highright) at ($ (lowright)+(0,-2mm) $);
          }
        }{}
        
      \end{tikzpicture}
    \end{frame}
  }{}%
}
\end{document}
